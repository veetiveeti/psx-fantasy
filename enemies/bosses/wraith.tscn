[gd_scene load_steps=10 format=3 uid="uid://ceyd644agwc52"]

[ext_resource type="PackedScene" uid="uid://cjxcfu43ribap" path="res://enemies/bosses/wraith.glb" id="1_x3fqq"]
[ext_resource type="Script" path="res://enemies/bosses/wraith.gd" id="2_p2vdo"]
[ext_resource type="PackedScene" uid="uid://cqeqw5hvxvymb" path="res://managers/stats_component.tscn" id="3_j3mac"]
[ext_resource type="PackedScene" uid="uid://dyg3f6o5pqlhd" path="res://enemies/bosses/wraith_effects/magic_missile.tscn" id="3_kyo50"]
[ext_resource type="PackedScene" uid="uid://bianxt3i2i24p" path="res://utils/health_bar_3d.tscn" id="4_55mtg"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ilynl"]
radius = 0.295454
height = 1.45495

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_larxf"]
radius = 0.987454
height = 3.93311

[sub_resource type="ViewportTexture" id="ViewportTexture_uoe0a"]
viewport_path = NodePath("SubViewport")

[sub_resource type="BoxShape3D" id="BoxShape3D_15rdb"]
size = Vector3(80, 80, 80)

[node name="wraith" groups=["enemy"] instance=ExtResource("1_x3fqq")]
transform = Transform3D(0.36, 0, 0, 0, 0.36, 0, 0, 0, 0.36, 0, 0, 0)
script = ExtResource("2_p2vdo")

[node name="Skeleton3D" parent="Armature" index="0"]
bones/0/position = Vector3(3.40006e-16, 0.105662, 0.0501339)
bones/0/rotation = Quaternion(0.0284113, 0.00315004, 0.0135383, 0.9995)
bones/0/scale = Vector3(1, 1, 1)
bones/1/rotation = Quaternion(-0.0187017, -0.00336929, 0.0132118, 0.999732)
bones/2/rotation = Quaternion(-0.0227133, 0.00800501, 0.994691, 0.100054)
bones/2/scale = Vector3(1, 1, 1.00001)
bones/3/rotation = Quaternion(-0.087773, 0.384677, 0.0506195, 0.917473)
bones/3/scale = Vector3(1, 1, 1)
bones/4/rotation = Quaternion(0.70858, -0.019491, -0.70536, -0.00124121)
bones/4/scale = Vector3(0.999998, 0.999999, 1.00001)
bones/5/rotation = Quaternion(-3.99139e-09, 1.48976e-08, 0.0436883, 0.999045)
bones/5/scale = Vector3(1, 1, 1)
bones/6/rotation = Quaternion(0.842649, 0.0573188, 0.0616018, -0.531849)
bones/6/scale = Vector3(1, 1, 1.00001)
bones/7/rotation = Quaternion(-0.244862, 0.719427, 0.2238, 0.61023)
bones/9/position = Vector3(0, -2.02626, 0.0202719)
bones/9/rotation = Quaternion(-0.5, 0.5, 0.5, -0.5)

[node name="BoneAttachment3D" type="BoneAttachment3D" parent="Armature/Skeleton3D" index="1"]
transform = Transform3D(-0.161984, -0.485749, 0.858958, -0.892614, -0.299006, -0.337421, 0.420738, -0.821367, -0.385147, 0.414496, 0.641539, -0.366767)
bone_name = "lowerarm.r"
bone_idx = 7

[node name="Hitbox" type="Area3D" parent="Armature/Skeleton3D/BoneAttachment3D" index="0"]
transform = Transform3D(0.953591, -0.294725, 0.0616827, 0.299908, 0.947932, -0.107154, -0.0268905, 0.120679, 0.992328, 0.0324178, 0.617849, -0.0259646)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Armature/Skeleton3D/BoneAttachment3D/Hitbox" index="0"]
transform = Transform3D(0.957279, 0.289165, 0, -0.289165, 0.957279, 0, 0, 0, 1, -0.0562942, 0, 0)
shape = SubResource("CapsuleShape3D_ilynl")

[node name="BoneAttachment3D2" type="BoneAttachment3D" parent="Armature/Skeleton3D" index="2"]
transform = Transform3D(-0.665803, -0.0069489, -0.746095, 0.123586, -0.987171, -0.101092, -0.735828, -0.159515, 0.658128, -0.455315, 0.33013, 0.0523297)
bone_name = "lowerarm.l"
bone_idx = 3

[node name="missile_position" type="Node3D" parent="Armature/Skeleton3D/BoneAttachment3D2" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.305967, 0.651057, -1.26867)

[node name="MagicMissile" parent="Armature/Skeleton3D/BoneAttachment3D2/missile_position" index="0" instance=ExtResource("3_kyo50")]
transform = Transform3D(1, -7.45058e-09, 8.84756e-09, -7.45058e-09, 1, 3.72529e-09, 3.95812e-09, 0, 1, 0.305967, -0.651057, 1.26867)
visible = false

[node name="AnimationPlayer" parent="." index="1"]
autoplay = "idle"
speed_scale = 1.4

[node name="CollisionShape3D" type="CollisionShape3D" parent="." index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.96041, 0)
shape = SubResource("CapsuleShape3D_larxf")

[node name="StatsComponent" parent="." index="3" instance=ExtResource("3_j3mac")]

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="." index="4"]

[node name="SubViewport" type="SubViewport" parent="." index="5"]
transparent_bg = true
size = Vector2i(40, 8)

[node name="EnemyHealthBar" parent="SubViewport" index="0" instance=ExtResource("4_55mtg")]

[node name="Sprite3D" type="Sprite3D" parent="." index="6"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.98657, 0)
texture = SubResource("ViewportTexture_uoe0a")

[node name="RayCast3D" type="RayCast3D" parent="." index="7"]
transform = Transform3D(140, 0, 0, 0, 10, 0, 0, 0, 1, 0, 3.10984, -0.592339)
target_position = Vector3(0, 0, -20)

[node name="DetectionZone" type="Area3D" parent="." index="8"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="DetectionZone" index="0"]
shape = SubResource("BoxShape3D_15rdb")

[connection signal="body_entered" from="Armature/Skeleton3D/BoneAttachment3D/Hitbox" to="." method="_on_hitbox_body_entered"]
